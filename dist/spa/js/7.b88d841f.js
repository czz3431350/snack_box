(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[7],{"126c":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",[a("q-dialog",{model:{value:t.dialog.item_info,callback:function(e){t.$set(t.dialog,"item_info",e)},expression:"dialog.item_info"}},[a("q-card",{staticClass:"my-card",staticStyle:{width:"90%"},attrs:{flat:""}},[a("q-card-section",{staticClass:"bg-teal text-white"},[a("div",{staticClass:"text-h6 q-ma-md"},[t._v(t._s(t.shop_address)+"货品详情")])]),a("q-card-section",[a("q-list",{staticClass:"rounded-borders",attrs:{padding:""}},t._l(t.item_list,(function(e){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{dense:"",clickable:""}},[a("q-item-section",[t._v("\n              "+t._s(e.itemName)+"\n            ")]),a("q-item-section",{attrs:{side:""}},[t._v("\n              "+t._s(e.stockCurrent)+"/"+t._s(e.stockMix)+"\n            ")])],1)})),1)],1),a("q-separator"),a("q-card-actions",{staticClass:"bg-white text-teal",attrs:{align:"right"}},[a("q-btn",{attrs:{flat:"",color:"red",label:"缺货"},on:{click:function(e){t.dialog.check_info=!0}}}),a("q-btn",{attrs:{flat:"",label:"确认"},on:{click:function(e){return t.checkShopPass()}}})],1)],1)],1),a("q-dialog",{model:{value:t.dialog.check_info,callback:function(e){t.$set(t.dialog,"check_info",e)},expression:"dialog.check_info"}},[a("q-card",{staticClass:"my-card",staticStyle:{width:"90%"},attrs:{flat:""}},[a("q-card-section",{staticClass:"bg-teal text-white"},[a("div",{staticClass:"text-h6 q-ma-md"},[t._v(t._s(t.shop_address)+"缺货详情")])]),a("q-card-section",[a("q-list",{staticClass:"rounded-borders",attrs:{padding:""}},t._l(t.item_list,(function(e){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{dense:"",clickable:""}},[a("q-item-section",[t._v("\n              "+t._s(e.itemName)+"\n            ")]),a("q-input",{staticClass:"col-3",attrs:{dense:"",type:"number",label:"缺货数量"},model:{value:e.defectNum,callback:function(a){t.$set(e,"defectNum",a)},expression:"item.defectNum"}})],1)})),1)],1),a("q-separator"),a("q-card-actions",{staticClass:"bg-white text-teal",attrs:{align:"right"}},[a("q-btn",{attrs:{flat:"",label:"提交"},on:{click:function(e){return t.checkShop()}}})],1)],1)],1),a("q-dialog",{model:{value:t.dialog.replenishment_info,callback:function(e){t.$set(t.dialog,"replenishment_info",e)},expression:"dialog.replenishment_info"}},[a("q-card",{staticClass:"my-card",staticStyle:{width:"90%"},attrs:{flat:""}},[a("q-card-section",{staticClass:"bg-teal text-white"},[a("div",{staticClass:"text-h6 q-ma-md"},[t._v(t._s(t.replenishment_info_detail.replenishmentShopAddress)+"补货单详情")])]),a("q-card-section",[a("q-list",{staticClass:"rounded-borders",attrs:{padding:""}},t._l(t.replenishment_info_detail.replenishmentInfo,(function(e){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{dense:"",clickable:""}},[a("q-item-section",[t._v("\n              "+t._s(e.replenishmentItemName)+" * "+t._s(e.replenishmentItemNum)+"\n            ")]),a("q-item-section",{attrs:{side:""}},[t._v("\n              ￥ "+t._s(e.replenishmentItemPrice)+"\n            ")])],1)})),1)],1),a("q-card-actions",{staticClass:"bg-white text-teal",attrs:{align:"right"}},[a("q-btn",{attrs:{flat:"",label:"确认"},on:{click:function(e){return t.confirmReplenishment()}}})],1)],1)],1),a("q-tabs",{staticClass:"q-mb-sm bg-grey-1",attrs:{align:"justify","narrow-indicator":""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("q-tab",{staticClass:"text-teal",attrs:{name:"ph",label:"盘货"}}),a("q-tab",{staticClass:"text-green",attrs:{name:"bh",label:"补货"}})],1),a("q-tab-panels",{attrs:{animated:"","transition-prev":"scale","transition-next":"scale"},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("q-tab-panel",{attrs:{name:"ph"}},[a("div",{staticClass:"q-pa-xs"},[a("div",{staticClass:"row"},t._l(t.shop_info,(function(e,s){return a("div",{key:e.shopId,staticClass:"col-6 q-pa-sm"},[a("q-card",{attrs:{flat:"",bordered:""},on:{click:function(a){return t.goShopDetail(e)}}},[a("q-linear-progress",{attrs:{size:"2px",value:1,color:e.shopState?"teal":"red"}}),a("q-card-section",[a("q-list",{directives:[{name:"ripple",rawName:"v-ripple",value:!1,expression:"false"}],staticClass:"rounded-borders",attrs:{padding:""}},[a("q-item",{directives:[{name:"ripple",rawName:"v-ripple",value:!1,expression:"false"}]},[a("q-item-section",{staticClass:"text-weight-bold"},[t._v("\n                      "+t._s(e.shopAddress)+"\n                    ")])],1)],1),a("q-separator"),a("q-card-actions",{staticClass:"text-grey"},[t._v("\n                  "+t._s(e.shopLastCheckTime)+"\n                ")])],1)],1)],1)})),0)])]),a("q-tab-panel",{attrs:{name:"bh"}},[a("div",{staticClass:"q-pa-xs"},[a("div",{staticClass:"row"},t._l(t.replenishment_info,(function(e,s){return a("div",{key:e.replenishmentItemId,staticClass:"col-6 q-pa-sm"},[a("q-card",{attrs:{flat:"",bordered:""},on:{click:function(a){return t.getReplenishmentDetailInfo(e)}}},[a("q-linear-progress",{attrs:{size:"2px",value:1,color:e.isFinish?"teal":"red"}}),a("q-card-section",[a("q-list",{directives:[{name:"ripple",rawName:"v-ripple",value:!1,expression:"false"}],staticClass:"rounded-borders",attrs:{padding:""}},[a("q-item",{directives:[{name:"ripple",rawName:"v-ripple",value:!1,expression:"false"}]},[a("q-item-section",{staticClass:"text-weight-bold"},[t._v("\n                      "+t._s(e.replenishmentShopAddress)+"\n                    ")])],1)],1),a("q-separator"),a("q-card-actions",{staticClass:"text-grey"},[t._v("\n                  "+t._s(e.CreatTime)+"\n                ")])],1)],1)],1)})),0)])])],1)],1)},i=[],n=a("bc3a"),o=a.n(n),c=a("4328"),r={name:"AdminManage",created:function(){this.findAllShopInfo(),this.findReplenishmentInfo()},data:function(){return{shop_info:"",replenishment_info:"",replenishment_info_detail:{ReplenishmentInfo:null},location:{id:0},tab:"ph",shop_address:null,item_list:null,shop_id:null,dialog:{item_info:!1,replenishment_info:!1,check_info:!1}}},methods:{findAllShopInfo:function(){var t=this;o.a.post(t.$store.state.url_paths.adminGetShops,c.stringify({access_token:t.$store.state.user_info.access_token})).then((function(e){t.shop_info=e.data.ShopInfo})).catch((function(e){t.$q.dialog({title:"网络错误",message:"错误信息：".concat(e)})}))},findReplenishmentInfo:function(){var t=this;o.a.post(t.$store.state.url_paths.findReplenishmentInfo,c.stringify({access_token:t.$store.state.user_info.access_token})).then((function(e){t.replenishment_info=e.data.data.info})).catch((function(e){t.$q.dialog({title:"网络错误",message:"错误信息：".concat(e)})}))},getReplenishmentDetailInfo:function(t){this.replenishment_info_detail=t,this.dialog.replenishment_info=!0,this.replenishment_info_detail.replenishmentInfo=JSON.parse(t.replenishmentInfo)},goShopDetail:function(t){var e=this;this.shop_address=t.shopAddress,this.shop_id=t.shopId,o.a.post(this.$store.state.url_paths.findItemInfoByShopId,c.stringify({access_token:this.$store.state.user_info.access_token,shop_id:t.shopId})).then((function(t){e.item_list=t.data.itemInfo,e.dialog.item_info=!0})).catch((function(t){e.$q.dialog({title:"网络错误",message:"错误信息：".concat(t)})}))},checkShopPass:function(){var t=this;this.$api.admin.checkShopPass(this.$store.state.user_info.access_token,this.shop_id).then((function(e){console.log(e),t.$q.notify({type:"negative",color:"green",position:"top",message:"".concat(t.shop_address,"盘货成功")}),t.findAllShopInfo(),t.dialog.item_info=!1})).catch((function(e){t.$q.dialog({title:"网络错误",message:"错误信息：".concat(e)})}))},checkShop:function(){var t=this,e=JSON.stringify(this.item_list.filter((function(t){return t.defectNum>0&&t.defectNum.length>0})));o.a.post("/admin/checkShop",c.stringify({access_token:this.$store.state.user_info.access_token,shop_id:this.shop_id,shop_json:e})).then((function(e){console.log(e);var a=e.data.appId,s=e.data.timeStamp,i=e.data.nonceStr,n=e.data.package,o=e.data.signType,c=e.data.paySign;alert("appId:".concat(a," ")+"timeStamp:".concat(s," ")+"nonceStr:".concat(i," ")+"package:".concat(n," ")+"signType:".concat(o," ")+"paySign:".concat(c," ")),WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:a,timeStamp:s,nonceStr:i,package:n,signType:o,paySign:c},(function(t){"get_brand_wcpay_request:ok"==t.err_msg?that.$q.notify({type:"negative",color:"green",position:"top",message:"支付成功"}):"get_brand_wcpay_request:cancel"==t.err_msg?that.$q.notify({type:"negative",color:"red",position:"top",message:"支付取消"}):"get_brand_wcpay_request:fail"==t.err_msg&&(that.$q.notify({type:"negative",color:"red",position:"top",message:"支付失败"}),alert(JSON.stringify(t)),WeixinJSBridge.call("closeWindow"))})),t.findAllShopInfo(),t.dialog.check_info=!1,t.dialog.item_info=!1})).catch((function(e){t.$q.dialog({title:"网络错误",message:"错误信息：".concat(e)})}))},confirmReplenishment:function(){var t=this;this.$api.user.updateReplenishment(this.$store.state.user_info.access_token,this.replenishment_info_detail.replenishmentItemId).then((function(e){t.findReplenishmentInfo(),t.$q.notify({type:"negative",color:"green",position:"top",message:"".concat(t.replenishment_info_detail.replenishmentShopAddress,"补货成功")}),t.dialog.replenishment_info=!1})).catch((function(e){t.$q.dialog({title:"网络错误",message:"错误信息：".concat(e)})}))}}},l=r,d=a("4023"),p=a("9989"),h=a("24e8"),m=a("f09f"),f=a("a370"),_=a("1c1c"),g=a("66e5"),u=a("4074"),q=a("eb85"),b=a("4b7e"),v=a("9c40"),k=a("27f9"),y=a("429b"),S=a("7460"),C=a("adad"),I=a("823b"),x=a("6b1d"),w=a("2c91"),$=a("714f"),N=a("b2a3"),Q=a.n(N),R=Object(d["a"])(l,s,i,!1,null,"4507f596",null);e["default"]=R.exports;Q()(R,"components",{QPage:p["a"],QDialog:h["a"],QCard:m["a"],QCardSection:f["a"],QList:_["a"],QItem:g["a"],QItemSection:u["a"],QSeparator:q["a"],QCardActions:b["a"],QBtn:v["a"],QInput:k["a"],QTabs:y["a"],QTab:S["a"],QTabPanels:C["a"],QTabPanel:I["a"],QLinearProgress:x["a"],QSpace:w["a"]}),Q()(R,"directives",{Ripple:$["a"]})}}]);